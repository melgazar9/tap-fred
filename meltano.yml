version: 1
send_anonymous_usage_stats: true
project_id: tap-fred
default_environment: dev
venv:
  backend: uv
environments:
- name: dev
- name: prod
plugins:
  extractors:
  - name: tap-fred
    namespace: tap_fred
    pip_url: -e .
    capabilities:
    - state
    - catalog
    - discover
    - about
    - stream-maps

    settings_group_validation:
    - [api_key]

    settings:
    - name: api_key
      kind: string
      label: FRED API Key
      description: Your FRED API key from 
        https://fred.stlouisfed.org/docs/api/api_key.html
      sensitive: true

    - name: series_ids
      label: Series IDs
      description: FRED series IDs to extract (e.g., 'GDP' or ['GDP', 'UNRATE'] 
        or '*' for defaults)

    - name: start_date
      kind: date_iso8601
      label: Start Date
      description: Earliest observation date to extract

    - name: api_url
      label: API Base URL
      description: FRED API base URL

    - name: user_agent
      label: User Agent
      description: Custom User-Agent header for requests

    - name: max_requests_per_minute
      label: Max Requests Per Minute
      description: Maximum API requests per minute (default 60, FRED allows up 
        to 120)
      default: 60

    - name: min_throttle_seconds
      label: Minimum Throttle Seconds
      description: Minimum seconds between consecutive API requests (default 1.0
        for 60/min rate)
      default: 1.0

    # Per-stream configurable query parameters (optional)
    - name: default_params
      kind: object
      label: Default Parameters
      description: Default query/path parameters for all streams

    - name: series_observations_params
      kind: object
      label: Series Observations Parameters
      description: Custom parameters for series_observations stream

    - name: releases_params
      kind: object
      label: Releases Parameters
      description: Custom parameters for releases stream

    # FRED vs ALFRED mode settings
    - name: data_mode
      kind: options
      label: Data Mode
      description: FRED for current revised data, ALFRED for vintage historical 
        data
      options:
      - label: FRED (Current Revised Data)
        value: FRED
      - label: ALFRED (Vintage Historical Data)
        value: ALFRED
      default: FRED

    - name: realtime_start
      kind: date_iso8601
      label: Realtime Start Date
      description: Start date for ALFRED vintage data (YYYY-MM-DD). Only used 
        when data_mode=ALFRED

    - name: realtime_end
      kind: date_iso8601
      label: Realtime End Date
      description: End date for ALFRED vintage data (YYYY-MM-DD). Only used when
        data_mode=ALFRED

    # Point-in-Time Mode Settings
    - name: point_in_time_mode
      kind: boolean
      label: Point-in-Time Mode
      description: Enable vintage date extraction for comprehensive backtesting data
      default: false

    - name: point_in_time_start
      kind: date_iso8601
      label: Point-in-Time Start Date
      description: Start date for filtering vintage dates (YYYY-MM-DD). Only used 
        when point_in_time_mode=true

    - name: point_in_time_end
      kind: date_iso8601
      label: Point-in-Time End Date
      description: End date for filtering vintage dates (YYYY-MM-DD). Only used when
        point_in_time_mode=true

    # Configurable Selection Filters
    - name: category_ids
      kind: array
      label: Category IDs
      description: Specific FRED category IDs to extract (e.g., ['18', '32992'] 
        or ['*'] for all)

    - name: release_ids
      kind: array
      label: Release IDs
      description: Specific FRED release IDs to extract (e.g., ['53', '151'] or 
        ['*'] for all)

    - name: source_ids
      kind: array
      label: Source IDs
      description: Specific FRED source IDs to extract (e.g., ['1', '3'] or 
        ['*'] for all)

    - name: tag_names
      kind: array
      label: Tag Names
      description: Specific FRED tag names to extract (e.g., ['gdp', 
        'inflation'] or ['*'] for all)

    - name: search_text
      label: Search Text
      description: Search term for series search streams (default empty)

    config:
      api_key: ${FRED_API_KEY}
      api_url: https://api.stlouisfed.org/fred
      start_date: '2020-01-01'
      max_requests_per_minute: 60
      min_throttle_seconds: 1.0

      series_ids: ["GDP", "UNRATE"]
      category_ids: ["*"]
      release_ids: ["*"]
      source_ids: ["*"]
      tag_names: ["*"]
      
      # Point-in-time mode for backtesting
      point_in_time_mode: true
      point_in_time_start: '2020-01-01'
      point_in_time_end: '2021-12-31'
      data_mode: ALFRED
      
      default_params:
        query_params:
          limit: 1000
    select:
      # Core data streams
    - series_observations.*

      # Series metadata streams  
    - series.*
    - series_categories.*
    - series_release.*
    - series_search.*
    - series_search_tags.*
    - series_search_related_tags.*
    - series_tags.*
    - series_updates.*
    - series_vintage_dates.*

      # Category hierarchy streams
    - categories.*
    - category_children.*
    - category_related.*
    - category_series.*
    - category_tags.*
    - category_related_tags.*

      # Release publication streams
    - releases.*
    - release.*
    - release_dates.*
    - release_series.*
    - release_sources.*
    - release_tags.*
    - release_related_tags.*
    - release_tables.*

      # Data source streams
    - sources.*
    - source.*
    - source_releases.*

      # Topic/keyword streams
    - tags.*
    - related_tags.*
    - tags_series.*

      # Geographic/regional streams (disabled for testing)
    # - geofred_regional_data.*
    # - geofred_series_data.*

  loaders:
  - name: target-jsonl
    variant: andyh1203
    pip_url: target-jsonl
